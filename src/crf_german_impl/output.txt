--------------------------------------------------------------------------- 
X.shape =  (2, 5, 3) 
X = 
 [[[ 1.  2.  3.]
  [ 4.  5.  6.]
  [ 7.  8.  9.]
  [10. 11. 12.]
  [13. 14. 15.]]

 [[16. 17. 18.]
  [19. 20. 21.]
  [22. 23. 24.]
  [25. 26. 27.]
  [28. 29. 30.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
self.kernel.shape =  (3, 4) 
self.kernel = 
 [[ 1.  2.  3.  4.]
 [ 5.  6.  7.  8.]
 [ 9. 10. 11. 12.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.dot(X, kernel).shape =  (2, 5, 4) 
K.dot(X, kernel) = 
 [[[ 38.  44.  50.  56.]
  [ 83.  98. 113. 128.]
  [128. 152. 176. 200.]
  [173. 206. 239. 272.]
  [218. 260. 302. 344.]]

 [[263. 314. 365. 416.]
  [308. 368. 428. 488.]
  [353. 422. 491. 560.]
  [398. 476. 554. 632.]
  [443. 530. 617. 704.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
self.bias.shape =  (4,) 
self.bias = 
 [1. 2. 3. 4.] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
(K.dot(X, self.kernel) + self.bias).shape =  (2, 5, 4) 
(K.dot(X, self.kernel) + self.bias) = 
 [[[ 39.  46.  53.  60.]
  [ 84. 100. 116. 132.]
  [129. 154. 179. 204.]
  [174. 208. 242. 276.]
  [219. 262. 305. 348.]]

 [[264. 316. 368. 420.]
  [309. 370. 431. 492.]
  [354. 424. 494. 564.]
  [399. 478. 557. 636.]
  [444. 532. 620. 708.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
input_energy=activation(K.dot(X, self.kernel) + self.bias).shape =  (2, 5, 4) 
input_energy=activation(K.dot(X, self.kernel) + self.bias) = 
 [[[ 39.  46.  53.  60.]
  [ 84. 100. 116. 132.]
  [129. 154. 179. 204.]
  [174. 208. 242. 276.]
  [219. 262. 305. 348.]]

 [[264. 316. 368. 420.]
  [309. 370. 431. 492.]
  [354. 424. 494. 564.]
  [399. 478. 557. 636.]
  [444. 532. 620. 708.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
start before expand.shape =  (4,) 
start before expand = 
 [1. 2. 3. 4.] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
start after expand = left_boundary; start.shape =  (1, 1, 4) 
start after expand = left_boundary; start = 
 [[[1. 2. 3. 4.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
end_before expand.shape =  (4,) 
end_before expand = 
 [1. 2. 3. 4.] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
end after expand=right_boundary; end.shape =  (1, 1, 4) 
end after expand=right_boundary; end = 
 [[[1. 2. 3. 4.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
mask.shape =  (2, 5) 
mask = 
 [[ True  True False  True False]
 [False  True  True False  True]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
mask after expand.shape =  (2, 5, 1) 
mask after expand = 
 [[[1.]
  [1.]
  [0.]
  [1.]
  [0.]]

 [[0.]
  [1.]
  [1.]
  [0.]
  [1.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
start_mask.shape =  (2, 5, 1) 
start_mask = 
 [[[1.]
  [0.]
  [0.]
  [1.]
  [0.]]

 [[0.]
  [1.]
  [0.]
  [0.]
  [1.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
end_mask.shape =  (2, 5, 1) 
end_mask = 
 [[[0.]
  [0.]
  [1.]
  [0.]
  [0.]]

 [[1.]
  [0.]
  [0.]
  [1.]
  [0.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
energy+start.shape =  (2, 5, 4) 
energy+start = 
 [[[ 40.  48.  56.  64.]
  [ 84. 100. 116. 132.]
  [129. 154. 179. 204.]
  [175. 210. 245. 280.]
  [219. 262. 305. 348.]]

 [[264. 316. 368. 420.]
  [310. 372. 434. 496.]
  [354. 424. 494. 564.]
  [399. 478. 557. 636.]
  [445. 534. 623. 712.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
energy+end.shape =  (2, 5, 4) 
energy+end = 
 [[[ 40.  48.  56.  64.]
  [ 84. 100. 116. 132.]
  [130. 156. 182. 208.]
  [175. 210. 245. 280.]
  [219. 262. 305. 348.]]

 [[265. 318. 371. 424.]
  [310. 372. 434. 496.]
  [354. 424. 494. 564.]
  [400. 480. 560. 640.]
  [445. 534. 623. 712.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
input_energy add boundary energy.shape =  (2, 5, 4) 
input_energy add boundary energy = 
 [[[ 40.  48.  56.  64.]
  [ 84. 100. 116. 132.]
  [130. 156. 182. 208.]
  [175. 210. 245. 280.]
  [219. 262. 305. 348.]]

 [[265. 318. 371. 424.]
  [310. 372. 434. 496.]
  [354. 424. 494. 564.]
  [400. 480. 560. 640.]
  [445. 534. 623. 712.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain_energy.shape =  (4, 4) 
chain_energy = 
 [[ 1.  2.  3.  4.]
 [ 5.  6.  7.  8.]
 [ 9. 10. 11. 12.]
 [13. 14. 15. 16.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain energy expand.shape =  (1, 4, 4) 
chain energy expand = 
 [[[ 1.  2.  3.  4.]
  [ 5.  6.  7.  8.]
  [ 9. 10. 11. 12.]
  [13. 14. 15. 16.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
prev_target_val.shape =  (2, 4) 
prev_target_val = 
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
initial_states.length =  2 
initial_states = 
 [array([[0., 0., 0., 0.],
       [0., 0., 0., 0.]], dtype=float32), array([[0.],
       [0.]], dtype=float32)] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
constants=[chain_energy].length =  1 
constants=[chain_energy] = 
 [array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
mask.shape =  (2, 5) 
mask = 
 [[ True  True False  True False]
 [False  True  True False  True]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.zeros_like(mask[:, :1]).shape =  (2, 1) 
K.zeros_like(mask[:, :1]) = 
 [[False]
 [False]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
mask2.shape =  (2, 6) 
mask2 = 
 [[1. 1. 0. 1. 0. 0.]
 [0. 1. 1. 0. 1. 0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
constants.length =  2 
constants = 
 [array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32), array([[1., 1., 0., 1., 0., 0.],
       [0., 1., 1., 0., 1., 0.]], dtype=float32)] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
input_energy.shape =  (2, 5, 4) 
input_energy = 
 [[[ 40.  48.  56.  64.]
  [ 84. 100. 116. 132.]
  [130. 156. 182. 208.]
  [175. 210. 245. 280.]
  [219. 262. 305. 348.]]

 [[265. 318. 371. 424.]
  [310. 372. 434. 496.]
  [354. 424. 494. 564.]
  [400. 480. 560. 640.]
  [445. 534. 623. 712.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.cast(i[0, 0], dtype=int32) = t.shape =  () 
K.cast(i[0, 0], dtype=int32) = t = 
 0 
 ---------------------------------------------------------------------------
len(states) in step 4
--------------------------------------------------------------------------- 
energy in step().shape =  (2, 4, 4) 
energy in step() = 
 [[[41. 42. 43. 44.]
  [53. 54. 55. 56.]
  [65. 66. 67. 68.]
  [77. 78. 79. 80.]]

 [[ 0.  0.  0.  0.]
  [ 0.  0.  0.  0.]
  [ 0.  0.  0.  0.]
  [ 0.  0.  0.  0.]]] 
 ---------------------------------------------------------------------------
