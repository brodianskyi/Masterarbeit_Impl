--------------------------------------------------------------------------- 
X.shape =  (2, 5, 3) 
X = 
 [[[ 1.  2.  3.]
  [ 4.  5.  6.]
  [ 7.  8.  9.]
  [10. 11. 12.]
  [13. 14. 15.]]

 [[16. 17. 18.]
  [19. 20. 21.]
  [22. 23. 24.]
  [25. 26. 27.]
  [28. 29. 30.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
self.kernel.shape =  (3, 4) 
self.kernel = 
 [[ 1.  2.  3.  4.]
 [ 5.  6.  7.  8.]
 [ 9. 10. 11. 12.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.dot(X, kernel).shape =  (2, 5, 4) 
K.dot(X, kernel) = 
 [[[ 38.  44.  50.  56.]
  [ 83.  98. 113. 128.]
  [128. 152. 176. 200.]
  [173. 206. 239. 272.]
  [218. 260. 302. 344.]]

 [[263. 314. 365. 416.]
  [308. 368. 428. 488.]
  [353. 422. 491. 560.]
  [398. 476. 554. 632.]
  [443. 530. 617. 704.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
self.bias.shape =  (4,) 
self.bias = 
 [1. 2. 3. 4.] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
(K.dot(X, self.kernel) + self.bias).shape =  (2, 5, 4) 
(K.dot(X, self.kernel) + self.bias) = 
 [[[ 39.  46.  53.  60.]
  [ 84. 100. 116. 132.]
  [129. 154. 179. 204.]
  [174. 208. 242. 276.]
  [219. 262. 305. 348.]]

 [[264. 316. 368. 420.]
  [309. 370. 431. 492.]
  [354. 424. 494. 564.]
  [399. 478. 557. 636.]
  [444. 532. 620. 708.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
input_energy=activation(K.dot(X, self.kernel) + self.bias).shape =  (2, 5, 4) 
input_energy=activation(K.dot(X, self.kernel) + self.bias) = 
 [[[ 39.  46.  53.  60.]
  [ 84. 100. 116. 132.]
  [129. 154. 179. 204.]
  [174. 208. 242. 276.]
  [219. 262. 305. 348.]]

 [[264. 316. 368. 420.]
  [309. 370. 431. 492.]
  [354. 424. 494. 564.]
  [399. 478. 557. 636.]
  [444. 532. 620. 708.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
start before expand.shape =  (4,) 
start before expand = 
 [1. 2. 3. 4.] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
start after expand = left_boundary; start.shape =  (1, 1, 4) 
start after expand = left_boundary; start = 
 [[[1. 2. 3. 4.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
end_before expand.shape =  (4,) 
end_before expand = 
 [1. 2. 3. 4.] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
end after expand=right_boundary; end.shape =  (1, 1, 4) 
end after expand=right_boundary; end = 
 [[[1. 2. 3. 4.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
mask.shape =  (2, 5) 
mask = 
 [[ True  True False  True False]
 [False  True  True False  True]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
mask after expand.shape =  (2, 5, 1) 
mask after expand = 
 [[[1.]
  [1.]
  [0.]
  [1.]
  [0.]]

 [[0.]
  [1.]
  [1.]
  [0.]
  [1.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
start_mask.shape =  (2, 5, 1) 
start_mask = 
 [[[1.]
  [0.]
  [0.]
  [1.]
  [0.]]

 [[0.]
  [1.]
  [0.]
  [0.]
  [1.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
end_mask.shape =  (2, 5, 1) 
end_mask = 
 [[[0.]
  [0.]
  [1.]
  [0.]
  [0.]]

 [[1.]
  [0.]
  [0.]
  [1.]
  [0.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
energy+start.shape =  (2, 5, 4) 
energy+start = 
 [[[ 40.  48.  56.  64.]
  [ 84. 100. 116. 132.]
  [129. 154. 179. 204.]
  [175. 210. 245. 280.]
  [219. 262. 305. 348.]]

 [[264. 316. 368. 420.]
  [310. 372. 434. 496.]
  [354. 424. 494. 564.]
  [399. 478. 557. 636.]
  [445. 534. 623. 712.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
energy+end.shape =  (2, 5, 4) 
energy+end = 
 [[[ 40.  48.  56.  64.]
  [ 84. 100. 116. 132.]
  [130. 156. 182. 208.]
  [175. 210. 245. 280.]
  [219. 262. 305. 348.]]

 [[265. 318. 371. 424.]
  [310. 372. 434. 496.]
  [354. 424. 494. 564.]
  [400. 480. 560. 640.]
  [445. 534. 623. 712.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
input_energy add boundary energy.shape =  (2, 5, 4) 
input_energy add boundary energy = 
 [[[ 40.  48.  56.  64.]
  [ 84. 100. 116. 132.]
  [130. 156. 182. 208.]
  [175. 210. 245. 280.]
  [219. 262. 305. 348.]]

 [[265. 318. 371. 424.]
  [310. 372. 434. 496.]
  [354. 424. 494. 564.]
  [400. 480. 560. 640.]
  [445. 534. 623. 712.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain_energy.shape =  (4, 4) 
chain_energy = 
 [[ 1.  2.  3.  4.]
 [ 5.  6.  7.  8.]
 [ 9. 10. 11. 12.]
 [13. 14. 15. 16.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain energy expand.shape =  (1, 4, 4) 
chain energy expand = 
 [[[ 1.  2.  3.  4.]
  [ 5.  6.  7.  8.]
  [ 9. 10. 11. 12.]
  [13. 14. 15. 16.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
prev_target_val.shape =  (2, 4) 
prev_target_val = 
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
initial_states.length =  2 
initial_states = 
 [<tf.Tensor: id=175, shape=(2, 4), dtype=float32, numpy=
array([[0., 0., 0., 0.],
       [0., 0., 0., 0.]], dtype=float32)>, <tf.Tensor: id=181, shape=(2, 1), dtype=float32, numpy=
array([[0.],
       [0.]], dtype=float32)>] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
constants=[chain_energy].length =  1 
constants=[chain_energy] = 
 [<tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
mask.shape =  (2, 5) 
mask = 
 [[ True  True False  True False]
 [False  True  True False  True]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.zeros_like(mask[:, :1]).shape =  (2, 1) 
K.zeros_like(mask[:, :1]) = 
 [[False]
 [False]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
mask2.shape =  (2, 6) 
mask2 = 
 [[1. 1. 0. 1. 0. 0.]
 [0. 1. 1. 0. 1. 0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
constants.length =  2 
constants = 
 [<tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>, <tf.Tensor: id=199, shape=(2, 6), dtype=float32, numpy=
array([[1., 1., 0., 1., 0., 0.],
       [0., 1., 1., 0., 1., 0.]], dtype=float32)>] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
input_energy.shape =  (2, 5, 4) 
input_energy = 
 [[[ 40.  48.  56.  64.]
  [ 84. 100. 116. 132.]
  [130. 156. 182. 208.]
  [175. 210. 245. 280.]
  [219. 262. 305. 348.]]

 [[265. 318. 371. 424.]
  [310. 372. 434. 496.]
  [354. 424. 494. 564.]
  [400. 480. 560. 640.]
  [445. 534. 623. 712.]]] 
 ---------------------------------------------------------------------------
return_logZ in step() False
--------------------------------------------------------------------------- 
input_energy_t.shape =  (2, 4) 
input_energy_t = 
 [[ 40.  48.  56.  64.]
 [265. 318. 371. 424.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states.length =  4 
states = 
 [<tf.Tensor: id=175, shape=(2, 4), dtype=float32, numpy=
array([[0., 0., 0., 0.],
       [0., 0., 0., 0.]], dtype=float32)>, <tf.Tensor: id=181, shape=(2, 1), dtype=float32, numpy=
array([[0.],
       [0.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>, <tf.Tensor: id=199, shape=(2, 6), dtype=float32, numpy=
array([[1., 1., 0., 1., 0., 0.],
       [0., 1., 1., 0., 1., 0.]], dtype=float32)>] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states[:3].length =  3 
states[:3] = 
 [<tf.Tensor: id=175, shape=(2, 4), dtype=float32, numpy=
array([[0., 0., 0., 0.],
       [0., 0., 0., 0.]], dtype=float32)>, <tf.Tensor: id=181, shape=(2, 1), dtype=float32, numpy=
array([[0.],
       [0.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
prev_target_val in step().shape =  (2, 4) 
prev_target_val in step() = 
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
i in step().shape =  (2, 1) 
i in step() = 
 [[0.]
 [0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain_energy in step().shape =  (1, 4, 4) 
chain_energy in step() = 
 [[[ 1.  2.  3.  4.]
  [ 5.  6.  7.  8.]
  [ 9. 10. 11. 12.]
  [13. 14. 15. 16.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.cast(i[0, 0], dtype=int32) = t.shape =  () 
K.cast(i[0, 0], dtype=int32) = t = 
 0 
 ---------------------------------------------------------------------------
len(states) in step 4
--------------------------------------------------------------------------- 
input_energy_t + prev_target_val.shape =  (2, 4) 
input_energy_t + prev_target_val = 
 [[40. 48. 56. 64.]
 [ 0.  0.  0.  0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.expand_dims(input_energy_t + prev_target_val, 2).shape =  (2, 4, 1) 
K.expand_dims(input_energy_t + prev_target_val, 2) = 
 [[[40.]
  [48.]
  [56.]
  [64.]]

 [[ 0.]
  [ 0.]
  [ 0.]
  [ 0.]]] 
 ---------------------------------------------------------------------------
return_logZ in step() False
--------------------------------------------------------------------------- 
input_energy_t.shape =  (2, 4) 
input_energy_t = 
 [[ 40.  48.  56.  64.]
 [265. 318. 371. 424.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states.length =  4 
states = 
 (<tf.Tensor: id=175, shape=(2, 4), dtype=float32, numpy=
array([[0., 0., 0., 0.],
       [0., 0., 0., 0.]], dtype=float32)>, <tf.Tensor: id=181, shape=(2, 1), dtype=float32, numpy=
array([[0.],
       [0.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>, <tf.Tensor: id=199, shape=(2, 6), dtype=float32, numpy=
array([[1., 1., 0., 1., 0., 0.],
       [0., 1., 1., 0., 1., 0.]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states[:3].length =  3 
states[:3] = 
 (<tf.Tensor: id=175, shape=(2, 4), dtype=float32, numpy=
array([[0., 0., 0., 0.],
       [0., 0., 0., 0.]], dtype=float32)>, <tf.Tensor: id=181, shape=(2, 1), dtype=float32, numpy=
array([[0.],
       [0.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
prev_target_val in step().shape =  (2, 4) 
prev_target_val in step() = 
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
i in step().shape =  (2, 1) 
i in step() = 
 [[0.]
 [0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain_energy in step().shape =  (1, 4, 4) 
chain_energy in step() = 
 [[[ 1.  2.  3.  4.]
  [ 5.  6.  7.  8.]
  [ 9. 10. 11. 12.]
  [13. 14. 15. 16.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.cast(i[0, 0], dtype=int32) = t.shape =  () 
K.cast(i[0, 0], dtype=int32) = t = 
 0 
 ---------------------------------------------------------------------------
len(states) in step 4
--------------------------------------------------------------------------- 
input_energy_t + prev_target_val.shape =  (2, 4) 
input_energy_t + prev_target_val = 
 [[40. 48. 56. 64.]
 [ 0.  0.  0.  0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.expand_dims(input_energy_t + prev_target_val, 2).shape =  (2, 4, 1) 
K.expand_dims(input_energy_t + prev_target_val, 2) = 
 [[[40.]
  [48.]
  [56.]
  [64.]]

 [[ 0.]
  [ 0.]
  [ 0.]
  [ 0.]]] 
 ---------------------------------------------------------------------------
return_logZ in step() False
--------------------------------------------------------------------------- 
input_energy_t.shape =  (2, 4) 
input_energy_t = 
 [[ 84. 100. 116. 132.]
 [310. 372. 434. 496.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states.length =  4 
states = 
 (<tf.Tensor: id=340, shape=(2, 4), dtype=float32, numpy=
array([[41., 42., 43., 44.],
       [ 0.,  0.,  0.,  0.]], dtype=float32)>, <tf.Tensor: id=345, shape=(2, 1), dtype=float32, numpy=
array([[1.],
       [1.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>, <tf.Tensor: id=199, shape=(2, 6), dtype=float32, numpy=
array([[1., 1., 0., 1., 0., 0.],
       [0., 1., 1., 0., 1., 0.]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states[:3].length =  3 
states[:3] = 
 (<tf.Tensor: id=340, shape=(2, 4), dtype=float32, numpy=
array([[41., 42., 43., 44.],
       [ 0.,  0.,  0.,  0.]], dtype=float32)>, <tf.Tensor: id=345, shape=(2, 1), dtype=float32, numpy=
array([[1.],
       [1.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
prev_target_val in step().shape =  (2, 4) 
prev_target_val in step() = 
 [[41. 42. 43. 44.]
 [ 0.  0.  0.  0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
i in step().shape =  (2, 1) 
i in step() = 
 [[1.]
 [1.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain_energy in step().shape =  (1, 4, 4) 
chain_energy in step() = 
 [[[ 1.  2.  3.  4.]
  [ 5.  6.  7.  8.]
  [ 9. 10. 11. 12.]
  [13. 14. 15. 16.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.cast(i[0, 0], dtype=int32) = t.shape =  () 
K.cast(i[0, 0], dtype=int32) = t = 
 1 
 ---------------------------------------------------------------------------
len(states) in step 4
--------------------------------------------------------------------------- 
input_energy_t + prev_target_val.shape =  (2, 4) 
input_energy_t + prev_target_val = 
 [[125. 142. 159. 176.]
 [310. 372. 434. 496.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.expand_dims(input_energy_t + prev_target_val, 2).shape =  (2, 4, 1) 
K.expand_dims(input_energy_t + prev_target_val, 2) = 
 [[[125.]
  [142.]
  [159.]
  [176.]]

 [[310.]
  [372.]
  [434.]
  [496.]]] 
 ---------------------------------------------------------------------------
return_logZ in step() False
--------------------------------------------------------------------------- 
input_energy_t.shape =  (2, 4) 
input_energy_t = 
 [[130. 156. 182. 208.]
 [354. 424. 494. 564.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states.length =  4 
states = 
 (<tf.Tensor: id=405, shape=(2, 4), dtype=float32, numpy=
array([[125., 125., 125., 125.],
       [311., 312., 313., 314.]], dtype=float32)>, <tf.Tensor: id=410, shape=(2, 1), dtype=float32, numpy=
array([[2.],
       [2.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>, <tf.Tensor: id=199, shape=(2, 6), dtype=float32, numpy=
array([[1., 1., 0., 1., 0., 0.],
       [0., 1., 1., 0., 1., 0.]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states[:3].length =  3 
states[:3] = 
 (<tf.Tensor: id=405, shape=(2, 4), dtype=float32, numpy=
array([[125., 125., 125., 125.],
       [311., 312., 313., 314.]], dtype=float32)>, <tf.Tensor: id=410, shape=(2, 1), dtype=float32, numpy=
array([[2.],
       [2.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
prev_target_val in step().shape =  (2, 4) 
prev_target_val in step() = 
 [[125. 125. 125. 125.]
 [311. 312. 313. 314.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
i in step().shape =  (2, 1) 
i in step() = 
 [[2.]
 [2.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain_energy in step().shape =  (1, 4, 4) 
chain_energy in step() = 
 [[[ 1.  2.  3.  4.]
  [ 5.  6.  7.  8.]
  [ 9. 10. 11. 12.]
  [13. 14. 15. 16.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.cast(i[0, 0], dtype=int32) = t.shape =  () 
K.cast(i[0, 0], dtype=int32) = t = 
 2 
 ---------------------------------------------------------------------------
len(states) in step 4
--------------------------------------------------------------------------- 
input_energy_t + prev_target_val.shape =  (2, 4) 
input_energy_t + prev_target_val = 
 [[125. 125. 125. 125.]
 [665. 736. 807. 878.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.expand_dims(input_energy_t + prev_target_val, 2).shape =  (2, 4, 1) 
K.expand_dims(input_energy_t + prev_target_val, 2) = 
 [[[125.]
  [125.]
  [125.]
  [125.]]

 [[665.]
  [736.]
  [807.]
  [878.]]] 
 ---------------------------------------------------------------------------
return_logZ in step() False
--------------------------------------------------------------------------- 
input_energy_t.shape =  (2, 4) 
input_energy_t = 
 [[175. 210. 245. 280.]
 [400. 480. 560. 640.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states.length =  4 
states = 
 (<tf.Tensor: id=470, shape=(2, 4), dtype=float32, numpy=
array([[125., 125., 125., 125.],
       [665., 665., 665., 665.]], dtype=float32)>, <tf.Tensor: id=475, shape=(2, 1), dtype=float32, numpy=
array([[3.],
       [3.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>, <tf.Tensor: id=199, shape=(2, 6), dtype=float32, numpy=
array([[1., 1., 0., 1., 0., 0.],
       [0., 1., 1., 0., 1., 0.]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states[:3].length =  3 
states[:3] = 
 (<tf.Tensor: id=470, shape=(2, 4), dtype=float32, numpy=
array([[125., 125., 125., 125.],
       [665., 665., 665., 665.]], dtype=float32)>, <tf.Tensor: id=475, shape=(2, 1), dtype=float32, numpy=
array([[3.],
       [3.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
prev_target_val in step().shape =  (2, 4) 
prev_target_val in step() = 
 [[125. 125. 125. 125.]
 [665. 665. 665. 665.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
i in step().shape =  (2, 1) 
i in step() = 
 [[3.]
 [3.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain_energy in step().shape =  (1, 4, 4) 
chain_energy in step() = 
 [[[ 1.  2.  3.  4.]
  [ 5.  6.  7.  8.]
  [ 9. 10. 11. 12.]
  [13. 14. 15. 16.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.cast(i[0, 0], dtype=int32) = t.shape =  () 
K.cast(i[0, 0], dtype=int32) = t = 
 3 
 ---------------------------------------------------------------------------
len(states) in step 4
--------------------------------------------------------------------------- 
input_energy_t + prev_target_val.shape =  (2, 4) 
input_energy_t + prev_target_val = 
 [[300. 335. 370. 405.]
 [665. 665. 665. 665.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.expand_dims(input_energy_t + prev_target_val, 2).shape =  (2, 4, 1) 
K.expand_dims(input_energy_t + prev_target_val, 2) = 
 [[[300.]
  [335.]
  [370.]
  [405.]]

 [[665.]
  [665.]
  [665.]
  [665.]]] 
 ---------------------------------------------------------------------------
return_logZ in step() False
--------------------------------------------------------------------------- 
input_energy_t.shape =  (2, 4) 
input_energy_t = 
 [[219. 262. 305. 348.]
 [445. 534. 623. 712.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states.length =  4 
states = 
 (<tf.Tensor: id=535, shape=(2, 4), dtype=float32, numpy=
array([[300., 300., 300., 300.],
       [665., 665., 665., 665.]], dtype=float32)>, <tf.Tensor: id=540, shape=(2, 1), dtype=float32, numpy=
array([[4.],
       [4.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>, <tf.Tensor: id=199, shape=(2, 6), dtype=float32, numpy=
array([[1., 1., 0., 1., 0., 0.],
       [0., 1., 1., 0., 1., 0.]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
states[:3].length =  3 
states[:3] = 
 (<tf.Tensor: id=535, shape=(2, 4), dtype=float32, numpy=
array([[300., 300., 300., 300.],
       [665., 665., 665., 665.]], dtype=float32)>, <tf.Tensor: id=540, shape=(2, 1), dtype=float32, numpy=
array([[4.],
       [4.]], dtype=float32)>, <tf.Tensor: id=169, shape=(1, 4, 4), dtype=float32, numpy=
array([[[ 1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.],
        [ 9., 10., 11., 12.],
        [13., 14., 15., 16.]]], dtype=float32)>) 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
prev_target_val in step().shape =  (2, 4) 
prev_target_val in step() = 
 [[300. 300. 300. 300.]
 [665. 665. 665. 665.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
i in step().shape =  (2, 1) 
i in step() = 
 [[4.]
 [4.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
chain_energy in step().shape =  (1, 4, 4) 
chain_energy in step() = 
 [[[ 1.  2.  3.  4.]
  [ 5.  6.  7.  8.]
  [ 9. 10. 11. 12.]
  [13. 14. 15. 16.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.cast(i[0, 0], dtype=int32) = t.shape =  () 
K.cast(i[0, 0], dtype=int32) = t = 
 4 
 ---------------------------------------------------------------------------
len(states) in step 4
--------------------------------------------------------------------------- 
input_energy_t + prev_target_val.shape =  (2, 4) 
input_energy_t + prev_target_val = 
 [[ 300.  300.  300.  300.]
 [1110. 1199. 1288. 1377.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.expand_dims(input_energy_t + prev_target_val, 2).shape =  (2, 4, 1) 
K.expand_dims(input_energy_t + prev_target_val, 2) = 
 [[[ 300.]
  [ 300.]
  [ 300.]
  [ 300.]]

 [[1110.]
  [1199.]
  [1288.]
  [1377.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
target_val_last.shape =  (2, 4) 
target_val_last = 
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
target_val_seq.shape =  (2, 5, 4) 
target_val_seq = 
 [[[0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]]

 [[0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]]] 
 ---------------------------------------------------------------------------
return_sequences in recursion() =  True
go_backwards in recursion() =  False
--------------------------------------------------------------------------- 
go_backwards = false, target_val_seq.shape =  (2, 5, 4) 
go_backwards = false, target_val_seq = 
 [[[0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]]

 [[0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
argmin_tables = self.recursion.shape =  (2, 5, 4) 
argmin_tables = self.recursion = 
 [[[0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]]

 [[0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]
  [0. 0. 0. 0.]]] 
 ---------------------------------------------------------------------------
--------------------------------------------------------------------------- 
K.cast(argmin_tables, int32); argmin_tables.shape =  (2, 5, 4) 
K.cast(argmin_tables, int32); argmin_tables = 
 [[[0 0 0 0]
  [0 0 0 0]
  [0 0 0 0]
  [0 0 0 0]
  [0 0 0 0]]

 [[0 0 0 0]
  [0 0 0 0]
  [0 0 0 0]
  [0 0 0 0]
  [0 0 0 0]]] 
 ---------------------------------------------------------------------------
